<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mine Playlister - Tr√∏stMig.dk</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,700&display=swap">
    <style>
        body {
            font-family: 'Roboto', Arial, sans-serif;
            background: #f8f9fa;
            color: #2d3748;
            margin: 0;
        }
        .nav-header {
            background: #fff;
            border-bottom: 1px solid #e2e8f0;
            padding: 15px 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.07);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .nav-logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: #7c3aed;
            text-decoration: none;
        }
        .nav-links {
            display: flex;
            gap: 20px;
        }
        .nav-link {
            color: #2d3748;
            text-decoration: none;
            font-weight: 500;
            padding: 8px 16px;
            border-radius: 8px;
            transition: all 0.2s ease;
        }
        .nav-link:hover {
            background: #f7fafc;
            color: #7c3aed;
        }
        .nav-link.primary {
            background: #7c3aed;
            color: white;
        }
        .nav-link.crisis {
            background: #ef4444;
            color: white;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
        .container {
            max-width: 1100px;
            margin: 40px auto 0 auto;
            padding: 20px;
        }
        .header {
            background: linear-gradient(135deg, #7c3aed 0%, #9333ea 100%);
            color: white;
            padding: 40px;
            border-radius: 20px;
            margin-bottom: 30px;
            text-align: center;
        }
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }
        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        .nav-bar {
            background: white;
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 30px;
            display: flex;
            gap: 10px;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.07);
        }
        .nav-btn {
            background: #f8f9fa;
            border: 2px solid #e2e8f0;
            padding: 10px 20px;
            border-radius: 10px;
            text-decoration: none;
            color: #2d3748;
            font-weight: 600;
            transition: all 0.2s ease;
        }
        .nav-btn:hover {
            border-color: #7c3aed;
            background: white;
        }
        .nav-btn.active {
            background: #7c3aed;
            color: white;
            border-color: #7c3aed;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.07);
            border: 1px solid #e2e8f0;
        }
        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        .card-title {
            font-size: 1.3rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .script-list {
            max-height: 300px;
            overflow-y: auto;
        }
        .script-item {
            padding: 12px;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .script-item:last-child {
            border-bottom: none;
        }
        .script-info h4 {
            font-size: 1rem;
            margin-bottom: 4px;
        }
        .script-info p {
            font-size: 0.9rem;
            color: #718096;
        }
        .btn {
            background: #7c3aed;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        .btn:hover {
            background: #6d28d9;
            transform: translateY(-1px);
        }
        .btn-small {
            padding: 6px 12px;
            font-size: 0.9rem;
        }
        .assessment-prompt {
            background: linear-gradient(135deg, #fef3c7, #fcd34d);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
        }
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            .header {
                padding: 30px 20px;
            }
            .header h1 {
                font-size: 2rem;
            }
            .grid {
                grid-template-columns: 1fr;
            }
            .nav-bar {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <nav class="nav-header">
        <a href="index.html" class="nav-logo">Tr√∏stMig.dk</a>
        <div class="nav-links">
            <a href="selvmordstanker.html" class="nav-link crisis">üö® Akut Hj√¶lp</a>
            <a href="Dashboard.html" class="nav-link">üìä Dashboard</a>
            <a href="playlists.html" class="nav-link active" id="nav-playlist-link">
                üéµ Playlister <span id="favorites-badge" style="display:none; background:#ef4444; color:white; font-size:0.8rem; border-radius:8px; padding:2px 7px; margin-left:4px; vertical-align:middle;">0</span>
            </a>
            <a href="angst.html" class="nav-link">‚ö° Angst</a>
            <a href="depression.html" class="nav-link">üß† Depression</a>
        </div>
        <a href="login.html" class="nav-link primary">üîê Login</a>
    </nav>
    <div class="container">
        <header class="header">
            <h1>üéµ Mine Playlister</h1>
            <p>Personaliserede lydsamlinger baseret p√• din mentale sundhed</p>
        </header>
        <nav class="nav-bar">
            <a href="Dashboard.html" class="nav-btn">üìä Dashboard</a>
            <a href="playlists.html" class="nav-btn active">üéµ Playlister</a>
            <a href="index.html" class="nav-btn">üè† Hjem</a>
            <button id="generate-playlist-btn" class="btn btn-small" style="margin-left:auto;">‚ú® Generer Playlist</button>
        </nav>
        <div id="assessment-prompt" class="assessment-prompt">
            <h3>üìã F√• personaliserede anbefalinger</h3>
            <p>Udfyld din mentale sundhedsvurdering for at f√• skr√¶ddersyede playlister</p>
            <a href="Dashboard.html" class="btn" style="margin-top: 10px;">G√• til Assessment</a>
        </div>
        <div class="grid" id="playlists-grid">
            <div class="card" id="recommended-playlist" style="display:none;"></div>
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">‚ù§Ô∏è Mine Favoritter</h2>
                    <button class="btn btn-small" onclick="playPlaylist('favorites')">‚ñ∂ Afspil</button>
                </div>
                <div id="favorites-list">
                    <p style="color: #718096; text-align: center; padding: 20px;">Ingen favoritter endnu. Tilf√∏j scripts fra andre sider.</p>
                </div>
            </div>
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">üïí Seneste</h2>
                </div>
                <div id="recent-playlists">
                    <p style="color: #718096; text-align: center; padding: 20px;">Ingen seneste playlister endnu.</p>
                </div>
            </div>
        </div>
        <!-- AI Playlist Popup -->
        <div id="ai-playlist-popup" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.4); z-index:2000; align-items:center; justify-content:center;">
            <div style="background:white; border-radius:18px; max-width:400px; width:90vw; margin:auto; padding:32px 24px; box-shadow:0 8px 32px rgba(0,0,0,0.18); position:relative;">
                <button onclick="closeAIPopup()" style="position:absolute; top:12px; right:16px; background:none; border:none; font-size:1.5rem; cursor:pointer;">‚úï</button>
                <h2 style="margin-bottom:18px; color:#7c3aed;">‚ú® AI Playliste</h2>
                <form id="ai-playlist-form">
                    <div style="margin-bottom:16px;">
                        <label>1. Hvilket hum√∏r er du i? <br><small>(1=Meget d√•rligt, 10=Super godt)</small></label><br>
                        <input type="range" min="1" max="10" value="5" id="ai-q1" style="width:100%;">
                    </div>
                    <div style="margin-bottom:16px;">
                        <label>2. Hvad vil du gerne opn√•?<br></label>
                        <select id="ai-q2" style="width:100%; padding:6px; border-radius:6px;">
                            <option value="calm">Ro og tryghed</option>
                            <option value="energy">Mere energi</option>
                            <option value="focus">Bedre fokus</option>
                            <option value="sleep">Bedre s√∏vn</option>
                        </select>
                    </div>
                    <div style="margin-bottom:16px;">
                        <label>3. Hvilket tema passer bedst?<br></label>
                        <select id="ai-q3" style="width:100%; padding:6px; border-radius:6px;">
                            <option value="anxiety">Angst/panik</option>
                            <option value="depression">Depression</option>
                            <option value="stress">Stress</option>
                            <option value="loneliness">Ensomhed</option>
                            <option value="motivation">Motivation</option>
                        </select>
                    </div>
                    <div style="margin-bottom:16px;">
                        <label>4. Foretrukken stemmetype?<br></label>
                        <select id="ai-q4" style="width:100%; padding:6px; border-radius:6px;">
                            <option value="male">Mand</option>
                            <option value="female">Kvinde</option>
                            <option value="any">Ligegyldigt</option>
                        </select>
                    </div>
                    <button type="submit" class="btn" style="width:100%;">Lav playliste</button>
                </form>
            </div>
        </div>
    </div>
    <script>
    // --- FAVORIT BADGE OG AUTO-OPDATERING ---
    function updateFavoritesBadge() {
        const favorites = JSON.parse(localStorage.getItem('favoriteScripts') || '[]');
        const badge = document.getElementById('favorites-badge');
        if (favorites.length > 0) {
            badge.textContent = favorites.length;
            badge.style.display = 'inline-block';
        } else {
            badge.style.display = 'none';
        }
        updateFavoritesList(favorites);
    }
    function updateFavoritesList(favorites) {
        const container = document.getElementById('favorites-list');
        if (!favorites || favorites.length === 0) {
            container.innerHTML = `<p style='color: #718096; text-align: center; padding: 20px;'>Ingen favoritter endnu. Tilf√∏j scripts fra andre sider.</p>`;
            return;
        }
        let html = '<div class="script-list">';
        favorites.forEach(id => {
            html += `<div class='script-item'><div class='script-info'><h4>${id}</h4></div><button class='btn btn-small' onclick="playAudioFile('${id}')">‚ñ∂</button></div>`;
        });
        html += '</div>';
        container.innerHTML = html;
    }
    // Opdater badge og favoritter ved load og n√•r localStorage √¶ndres
    document.addEventListener('DOMContentLoaded', updateFavoritesBadge);
    window.addEventListener('storage', function(e) {
        if (e.key === 'favoriteScripts') updateFavoritesBadge();
    });
    // --- AI Playlist Popup logic ---
    const aiPopup = document.getElementById('ai-playlist-popup');
    document.getElementById('generate-playlist-btn').onclick = function(e) {
        e.preventDefault();
        aiPopup.style.display = 'flex';
    };
    function closeAIPopup() {
        aiPopup.style.display = 'none';
    }
    document.getElementById('ai-playlist-form').onsubmit = function(e) {
        e.preventDefault();
        const mood = parseInt(document.getElementById('ai-q1').value);
        const goal = document.getElementById('ai-q2').value;
        const theme = document.getElementById('ai-q3').value;
        const voice = document.getElementById('ai-q4').value;
        generateAIPlaylist(mood, goal, theme, voice);
        closeAIPopup();
    };
    function generateAIPlaylist(mood, goal, theme, voicePref) {
        const audioFiles = [
            {id:'psyk_panik_eksponering', title:'Eksponering mod panik', theme:'anxiety', voice:'male'},
            {id:'psyk_panik_triggers', title:'Forst√• dine triggere', theme:'anxiety', voice:'female'},
            {id:'psyk_aande_2', title:'Rolig vejrtr√¶kning', theme:'anxiety', voice:'male'},
            {id:'psyk_derealisering_1', title:'H√•ndter derealisering', theme:'anxiety', voice:'female'},
            {id:'psyk_dodsangst_1', title:'D√∏dsangst ‚Äì du er ikke alene', theme:'anxiety', voice:'male'},
            {id:'psyk_hjerte_1', title:'Hjertebanken og ro', theme:'anxiety', voice:'male'},
            {id:'psyk_panik_livssstil', title:'Livsstil og panik', theme:'anxiety', voice:'female'},
            {id:'psyk_aande_3', title:'Vejrtr√¶kning for ro', theme:'stress', voice:'female'},
            {id:'psyk_aande_4', title:'Afslapning', theme:'stress', voice:'male'},
            {id:'psyk_derealisering_2', title:'Styrk n√¶rv√¶r', theme:'stress', voice:'female'},
            {id:'psyk_dodsangst_2', title:'Frygt og accept', theme:'depression', voice:'male'},
            {id:'psyk_dodsangst_3', title:'Find h√•b', theme:'depression', voice:'female'},
            {id:'psyk_hjerte_2', title:'Hjertebanken og tryghed', theme:'depression', voice:'male'},
            {id:'psyk_hjerte_3', title:'Hjertebanken og styrke', theme:'depression', voice:'female'},
            {id:'psyk_derealisering_3', title:'Styrk dig selv', theme:'motivation', voice:'male'},
            {id:'psyk_derealisering_4', title:'Motivation og energi', theme:'motivation', voice:'female'},
            {id:'psykdodsangst4', title:'Du er st√¶rkere end du tror', theme:'motivation', voice:'male'}
        ];
        let filtered = audioFiles.filter(f => f.theme === theme);
        if (voicePref !== 'any') filtered = filtered.filter(f => f.voice === voicePref);
        if (filtered.length === 0) filtered = audioFiles.filter(f => f.theme === theme);
        if (filtered.length === 0) filtered = audioFiles;
        let playlist = filtered.slice(0, 4);
        showAIPlaylist(playlist, theme, goal, mood);
    }
    function showAIPlaylist(playlist, theme, goal, mood) {
        const card = document.getElementById('recommended-playlist');
        let html = `<div class='card-header'><h2 class='card-title'>‚ú® Anbefalet for dig</h2></div>`;
        html += `<p style='margin-bottom:15px;font-style:italic;'>Din AI-playliste for <b>${theme}</b> ‚Äì m√•l: <b>${goal}</b> ‚Äì hum√∏r: <b>${mood}</b></p><div class='script-list'>`;
        playlist.forEach(track => {
            html += `<div class='script-item'><div class='script-info'><h4>${track.title}</h4><p>${track.theme}</p></div><button class='btn btn-small' onclick="playAudioFile('${track.id}')">‚ñ∂</button></div>`;
        });
        html += '</div>';
        card.innerHTML = html;
        card.style.display = 'block';
        document.getElementById('assessment-prompt').style.display = 'none';
    }
    window.playAudioFile = function(id) {
        alert('Afspiller: ' + id);
    }
    window.closeAIPopup = closeAIPopup;
    </script>
</body>
</html>
